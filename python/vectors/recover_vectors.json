{
    "valid_test_cases": [
        {
            "hostseckey": "ADE179B2C56CB75868D44B333C16C89CB00DFDE378AD79C84D0CCE856E4F9207",
            "recovery_data": "0000000203B74C6FD38288DDF94300E887B12DD40F655791144A07C32487FBD81CC228C07903B9C3F15E5C0E086EDE931D69BABD36167BE6CCA8705378F8849A4F00EDA2941303AED316469060698D774150EFD7F8F406A2BAB516DD7D22CB258323C59C6417F303AEB5AE20783D4858F6767747963F144C7DB8ABA328625CC8A87F7676D8CDEEE7021A48BBCCAC751AE9EC1EA7A7F8D421D5FD60AAB44E6D2F37B31873098A77B7A30260537C74BC2B79676CDE217FFA7D48236D4A309954153DEB39A31AADF6B369CC022E7B7DD7A0B4A72097703E60648B615A4DDDF2D715A5E0992379537A44C13AD103D1FD5A186167E5DE84B11C0F56E1FC6808D2DB35E6E3587243CF59DE605CB806E242A37A2E03838EDCB4B064425FBA5F5F8331EDDF79B46AACC70EEB714995A27B5A879577BDAF956EC9F1C234BD3942E2B2F0E372902637993C54815B69F7EAFF288C16C20D3F8D26B64E23599E6996A833E286FEAD5A7490151202E859E484359973EEDDB358A5DF67A8F51EE4B4849877711B2F03A8B911E5365A5F580E6740F0CB72B94409488A4918624C3501EBEA14A65777BF59E390E0F2973A39D87F6EED8B1E9FF0C540CA119BCBBCC3E67D45A5F3BA3CAB251EC9C00B65E58C3C9AAD0DC5DFD9D9FB4624BA1313598AD5B21CDA916876307B3C1AEBF0D0A20A9F419E759E4AC146A6564712B6A0177F9DC7F03F56B7DEF40E7E0925EE99965568FF66F8D06CF0276DDAE74125FC34020DC6EA57C108562FB4908DA67E307BD74514",
            "expected_output": {
                "dkg_output": {
                    "secshare": "CF1009015DDCBEB326BC5C7C556CECAC8BCA838ECAA0627DC6D9E1367589AB85",
                    "threshold_pubkey": "021979452A2E878B2A5BB662F293D23C5795991FB984A8DFDE6EAA885AB72B311A",
                    "pubshares": [
                        "03D5DF677B4FD40950902A2D3D6469723FADCE0CDD939C8150937EF1D15801DDBC",
                        "03B53DF94A01A578300EBB5095B36668E810FE030C200F887CD9BD7F3AD40F31CA",
                        "0377FADE50E2F82A4FD697CF403F8C717E8614199AA87458BCB8A16E6289C26F8B"
                    ]
                },
                "params": {
                    "hostpubkeys": [
                        "03AED316469060698D774150EFD7F8F406A2BAB516DD7D22CB258323C59C6417F3",
                        "03AEB5AE20783D4858F6767747963F144C7DB8ABA328625CC8A87F7676D8CDEEE7",
                        "021A48BBCCAC751AE9EC1EA7A7F8D421D5FD60AAB44E6D2F37B31873098A77B7A3"
                    ],
                    "t": 2
                }
            },
            "comment": "participant recovery"
        },
        {
            "hostseckey": null,
            "recovery_data": "0000000203B74C6FD38288DDF94300E887B12DD40F655791144A07C32487FBD81CC228C07903B9C3F15E5C0E086EDE931D69BABD36167BE6CCA8705378F8849A4F00EDA2941303AED316469060698D774150EFD7F8F406A2BAB516DD7D22CB258323C59C6417F303AEB5AE20783D4858F6767747963F144C7DB8ABA328625CC8A87F7676D8CDEEE7021A48BBCCAC751AE9EC1EA7A7F8D421D5FD60AAB44E6D2F37B31873098A77B7A30260537C74BC2B79676CDE217FFA7D48236D4A309954153DEB39A31AADF6B369CC022E7B7DD7A0B4A72097703E60648B615A4DDDF2D715A5E0992379537A44C13AD103D1FD5A186167E5DE84B11C0F56E1FC6808D2DB35E6E3587243CF59DE605CB806E242A37A2E03838EDCB4B064425FBA5F5F8331EDDF79B46AACC70EEB714995A27B5A879577BDAF956EC9F1C234BD3942E2B2F0E372902637993C54815B69F7EAFF288C16C20D3F8D26B64E23599E6996A833E286FEAD5A7490151202E859E484359973EEDDB358A5DF67A8F51EE4B4849877711B2F03A8B911E5365A5F580E6740F0CB72B94409488A4918624C3501EBEA14A65777BF59E390E0F2973A39D87F6EED8B1E9FF0C540CA119BCBBCC3E67D45A5F3BA3CAB251EC9C00B65E58C3C9AAD0DC5DFD9D9FB4624BA1313598AD5B21CDA916876307B3C1AEBF0D0A20A9F419E759E4AC146A6564712B6A0177F9DC7F03F56B7DEF40E7E0925EE99965568FF66F8D06CF0276DDAE74125FC34020DC6EA57C108562FB4908DA67E307BD74514",
            "expected_output": {
                "dkg_output": {
                    "secshare": null,
                    "threshold_pubkey": "021979452A2E878B2A5BB662F293D23C5795991FB984A8DFDE6EAA885AB72B311A",
                    "pubshares": [
                        "03D5DF677B4FD40950902A2D3D6469723FADCE0CDD939C8150937EF1D15801DDBC",
                        "03B53DF94A01A578300EBB5095B36668E810FE030C200F887CD9BD7F3AD40F31CA",
                        "0377FADE50E2F82A4FD697CF403F8C717E8614199AA87458BCB8A16E6289C26F8B"
                    ]
                },
                "params": {
                    "hostpubkeys": [
                        "03AED316469060698D774150EFD7F8F406A2BAB516DD7D22CB258323C59C6417F3",
                        "03AEB5AE20783D4858F6767747963F144C7DB8ABA328625CC8A87F7676D8CDEEE7",
                        "021A48BBCCAC751AE9EC1EA7A7F8D421D5FD60AAB44E6D2F37B31873098A77B7A3"
                    ],
                    "t": 2
                }
            },
            "comment": "coordinator recovery"
        }
    ],
    "error_test_cases": [
        {
            "hostseckey": null,
            "recovery_data": "00000203B74C6FD38288DDF94300E887B12DD40F655791144A07C32487FBD81CC228C07903B9C3F15E5C0E086EDE931D69BABD36167BE6CCA8705378F8849A4F00EDA2941303AED316469060698D774150EFD7F8F406A2BAB516DD7D22CB258323C59C6417F303AEB5AE20783D4858F6767747963F144C7DB8ABA328625CC8A87F7676D8CDEEE7021A48BBCCAC751AE9EC1EA7A7F8D421D5FD60AAB44E6D2F37B31873098A77B7A30260537C74BC2B79676CDE217FFA7D48236D4A309954153DEB39A31AADF6B369CC022E7B7DD7A0B4A72097703E60648B615A4DDDF2D715A5E0992379537A44C13AD103D1FD5A186167E5DE84B11C0F56E1FC6808D2DB35E6E3587243CF59DE605CB806E242A37A2E03838EDCB4B064425FBA5F5F8331EDDF79B46AACC70EEB714995A27B5A879577BDAF956EC9F1C234BD3942E2B2F0E372902637993C54815B69F7EAFF288C16C20D3F8D26B64E23599E6996A833E286FEAD5A7490151202E859E484359973EEDDB358A5DF67A8F51EE4B4849877711B2F03A8B911E5365A5F580E6740F0CB72B94409488A4918624C3501EBEA14A65777BF59E390E0F2973A39D87F6EED8B1E9FF0C540CA119BCBBCC3E67D45A5F3BA3CAB251EC9C00B65E58C3C9AAD0DC5DFD9D9FB4624BA1313598AD5B21CDA916876307B3C1AEBF0D0A20A9F419E759E4AC146A6564712B6A0177F9DC7F03F56B7DEF40E7E0925EE99965568FF66F8D06CF0276DDAE74125FC34020DC6EA57C108562FB4908DA67E307BD74514",
            "error": {
                "type": "RecoveryDataError",
                "message": "Failed to deserialize recovery data"
            },
            "comment": "recovery data of invalid length"
        },
        {
            "hostseckey": null,
            "recovery_data": "0000000203000000000000000000000000000000000000000000000000000000000000000503B9C3F15E5C0E086EDE931D69BABD36167BE6CCA8705378F8849A4F00EDA2941303AED316469060698D774150EFD7F8F406A2BAB516DD7D22CB258323C59C6417F303AEB5AE20783D4858F6767747963F144C7DB8ABA328625CC8A87F7676D8CDEEE7021A48BBCCAC751AE9EC1EA7A7F8D421D5FD60AAB44E6D2F37B31873098A77B7A30260537C74BC2B79676CDE217FFA7D48236D4A309954153DEB39A31AADF6B369CC022E7B7DD7A0B4A72097703E60648B615A4DDDF2D715A5E0992379537A44C13AD103D1FD5A186167E5DE84B11C0F56E1FC6808D2DB35E6E3587243CF59DE605CB806E242A37A2E03838EDCB4B064425FBA5F5F8331EDDF79B46AACC70EEB714995A27B5A879577BDAF956EC9F1C234BD3942E2B2F0E372902637993C54815B69F7EAFF288C16C20D3F8D26B64E23599E6996A833E286FEAD5A7490151202E859E484359973EEDDB358A5DF67A8F51EE4B4849877711B2F03A8B911E5365A5F580E6740F0CB72B94409488A4918624C3501EBEA14A65777BF59E390E0F2973A39D87F6EED8B1E9FF0C540CA119BCBBCC3E67D45A5F3BA3CAB251EC9C00B65E58C3C9AAD0DC5DFD9D9FB4624BA1313598AD5B21CDA916876307B3C1AEBF0D0A20A9F419E759E4AC146A6564712B6A0177F9DC7F03F56B7DEF40E7E0925EE99965568FF66F8D06CF0276DDAE74125FC34020DC6EA57C108562FB4908DA67E307BD74514",
            "error": {
                "type": "RecoveryDataError",
                "message": "Failed to deserialize recovery data"
            },
            "comment": "first coefficient of sum_coms is invalid"
        },
        {
            "hostseckey": null,
            "recovery_data": "0000000203B74C6FD38288DDF94300E887B12DD40F655791144A07C32487FBD81CC228C07903B9C3F15E5C0E086EDE931D69BABD36167BE6CCA8705378F8849A4F00EDA2941303AED316469060698D774150EFD7F8F406A2BAB516DD7D22CB258323C59C6417F303AEB5AE20783D4858F6767747963F144C7DB8ABA328625CC8A87F7676D8CDEEE7021A48BBCCAC751AE9EC1EA7A7F8D421D5FD60AAB44E6D2F37B31873098A77B7A30260537C74BC2B79676CDE217FFA7D48236D4A309954153DEB39A31AADF6B369CC022E7B7DD7A0B4A72097703E60648B615A4DDDF2D715A5E0992379537A44C13AD103D1FD5A186167E5DE84B11C0F56E1FC6808D2DB35E6E3587243CF59DE605CB806E242A37A2E03838EDCB4B064425FBA5F5F8331EDDF79B46AACC70EEB714995A27B5A879577BDAF956EC9F1C234BD3942E2B2F0E372902637993C54815B69F7EAFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEBAAEDCE6AF48A03BBFD25E8CD0364141359973EEDDB358A5DF67A8F51EE4B4849877711B2F03A8B911E5365A5F580E6740F0CB72B94409488A4918624C3501EBEA14A65777BF59E390E0F2973A39D87F6EED8B1E9FF0C540CA119BCBBCC3E67D45A5F3BA3CAB251EC9C00B65E58C3C9AAD0DC5DFD9D9FB4624BA1313598AD5B21CDA916876307B3C1AEBF0D0A20A9F419E759E4AC146A6564712B6A0177F9DC7F03F56B7DEF40E7E0925EE99965568FF66F8D06CF0276DDAE74125FC34020DC6EA57C108562FB4908DA67E307BD74514",
            "error": {
                "type": "RecoveryDataError",
                "message": "Failed to deserialize recovery data"
            },
            "comment": "last share in enc_secshare list is invalid"
        },
        {
            "hostseckey": null,
            "recovery_data": "0000000003B74C6FD38288DDF94300E887B12DD40F655791144A07C32487FBD81CC228C07903B9C3F15E5C0E086EDE931D69BABD36167BE6CCA8705378F8849A4F00EDA2941303AED316469060698D774150EFD7F8F406A2BAB516DD7D22CB258323C59C6417F303AEB5AE20783D4858F6767747963F144C7DB8ABA328625CC8A87F7676D8CDEEE7021A48BBCCAC751AE9EC1EA7A7F8D421D5FD60AAB44E6D2F37B31873098A77B7A30260537C74BC2B79676CDE217FFA7D48236D4A309954153DEB39A31AADF6B369CC022E7B7DD7A0B4A72097703E60648B615A4DDDF2D715A5E0992379537A44C13AD103D1FD5A186167E5DE84B11C0F56E1FC6808D2DB35E6E3587243CF59DE605CB806E242A37A2E03838EDCB4B064425FBA5F5F8331EDDF79B46AACC70EEB714995A27B5A879577BDAF956EC9F1C234BD3942E2B2F0E372902637993C54815B69F7EAFF288C16C20D3F8D26B64E23599E6996A833E286FEAD5A7490151202E859E484359973EEDDB358A5DF67A8F51EE4B4849877711B2F03A8B911E5365A5F580E6740F0CB72B94409488A4918624C3501EBEA14A65777BF59E390E0F2973A39D87F6EED8B1E9FF0C540CA119BCBBCC3E67D45A5F3BA3CAB251EC9C00B65E58C3C9AAD0DC5DFD9D9FB4624BA1313598AD5B21CDA916876307B3C1AEBF0D0A20A9F419E759E4AC146A6564712B6A0177F9DC7F03F56B7DEF40E7E0925EE99965568FF66F8D06CF0276DDAE74125FC34020DC6EA57C108562FB4908DA67E307BD74514",
            "error": {
                "type": "RecoveryDataError",
                "message": "Failed to deserialize recovery data"
            },
            "comment": "invalid threshold"
        },
        {
            "hostseckey": null,
            "recovery_data": "0000000203B74C6FD38288DDF94300E887B12DD40F655791144A07C32487FBD81CC228C07903B9C3F15E5C0E086EDE931D69BABD36167BE6CCA8705378F8849A4F00EDA2941303000000000000000000000000000000000000000000000000000000000000000503AEB5AE20783D4858F6767747963F144C7DB8ABA328625CC8A87F7676D8CDEEE7021A48BBCCAC751AE9EC1EA7A7F8D421D5FD60AAB44E6D2F37B31873098A77B7A30260537C74BC2B79676CDE217FFA7D48236D4A309954153DEB39A31AADF6B369CC022E7B7DD7A0B4A72097703E60648B615A4DDDF2D715A5E0992379537A44C13AD103D1FD5A186167E5DE84B11C0F56E1FC6808D2DB35E6E3587243CF59DE605CB806E242A37A2E03838EDCB4B064425FBA5F5F8331EDDF79B46AACC70EEB714995A27B5A879577BDAF956EC9F1C234BD3942E2B2F0E372902637993C54815B69F7EAFF288C16C20D3F8D26B64E23599E6996A833E286FEAD5A7490151202E859E484359973EEDDB358A5DF67A8F51EE4B4849877711B2F03A8B911E5365A5F580E6740F0CB72B94409488A4918624C3501EBEA14A65777BF59E390E0F2973A39D87F6EED8B1E9FF0C540CA119BCBBCC3E67D45A5F3BA3CAB251EC9C00B65E58C3C9AAD0DC5DFD9D9FB4624BA1313598AD5B21CDA916876307B3C1AEBF0D0A20A9F419E759E4AC146A6564712B6A0177F9DC7F03F56B7DEF40E7E0925EE99965568FF66F8D06CF0276DDAE74125FC34020DC6EA57C108562FB4908DA67E307BD74514",
            "error": {
                "type": "RecoveryDataError",
                "message": "Invalid session parameters in recovery data"
            },
            "comment": "invalid threshold"
        },
        {
            "hostseckey": null,
            "recovery_data": "0000000203B74C6FD38288DDF94300E887B12DD40F655791144A07C32487FBD81CC228C07903B9C3F15E5C0E086EDE931D69BABD36167BE6CCA8705378F8849A4F00EDA2941303AED316469060698D774150EFD7F8F406A2BAB516DD7D22CB258323C59C6417F303AEB5AE20783D4858F6767747963F144C7DB8ABA328625CC8A87F7676D8CDEEE7021A48BBCCAC751AE9EC1EA7A7F8D421D5FD60AAB44E6D2F37B31873098A77B7A30260537C74BC2B79676CDE217FFA7D48236D4A309954153DEB39A31AADF6B369CC022E7B7DD7A0B4A72097703E60648B615A4DDDF2D715A5E0992379537A44C13AD103421F5FC9A21065445C96FDB91C0C1E2F2431741C72713B4B99DDCB316F31E9FCE242A37A2E03838EDCB4B064425FBA5F5F8331EDDF79B46AACC70EEB714995A27B5A879577BDAF956EC9F1C234BD3942E2B2F0E372902637993C54815B69F7EAFF288C16C20D3F8D26B64E23599E6996A833E286FEAD5A7490151202E859E484359973EEDDB358A5DF67A8F51EE4B4849877711B2F03A8B911E5365A5F580E6740F0CB72B94409488A4918624C3501EBEA14A65777BF59E390E0F2973A39D87F6EED8B1E9FF0C540CA119BCBBCC3E67D45A5F3BA3CAB251EC9C00B65E58C3C9AAD0DC5DFD9D9FB4624BA1313598AD5B21CDA916876307B3C1AEBF0D0A20A9F419E759E4AC146A6564712B6A0177F9DC7F03F56B7DEF40E7E0925EE99965568FF66F8D06CF0276DDAE74125FC34020DC6EA57C108562FB4908DA67E307BD74514",
            "error": {
                "type": "RecoveryDataError",
                "message": "Invalid certificate in recovery data"
            },
            "comment": "last pubnonce in the pubnonces list is invalid"
        },
        {
            "hostseckey": null,
            "recovery_data": "0000000203B74C6FD38288DDF94300E887B12DD40F655791144A07C32487FBD81CC228C07903B9C3F15E5C0E086EDE931D69BABD36167BE6CCA8705378F8849A4F00EDA2941303AED316469060698D774150EFD7F8F406A2BAB516DD7D22CB258323C59C6417F303AEB5AE20783D4858F6767747963F144C7DB8ABA328625CC8A87F7676D8CDEEE7021A48BBCCAC751AE9EC1EA7A7F8D421D5FD60AAB44E6D2F37B31873098A77B7A30260537C74BC2B79676CDE217FFA7D48236D4A309954153DEB39A31AADF6B369CC022E7B7DD7A0B4A72097703E60648B615A4DDDF2D715A5E0992379537A44C13AD103D1FD5A186167E5DE84B11C0F56E1FC6808D2DB35E6E3587243CF59DE605CB806E242A37A2E03838EDCB4B064425FBA5F5F8331EDDF79B46AACC70EEB714995A27B5A879577BDAF956EC9F1C234BD3942E2B2F0E372902637993C54815B69F7EAFF288C16C20D3F8D26B64E23599E6996A833E286FEAD5A7490151202E859E484359973EEDDB358A5DF67A8F51EE4B4849877711B2F03A8B911E5365A5F580E6740F0CB72B94409488A4918624C3501EBEA14A65777BF59E390E0F2973A39D87F6EED8B1E9FF0C540CA119BCBBCC3E67D45A5F3BA3CAB251EC9C00B65E58C3C9AAD0DC5DFD9D9FB4624BA1313598AD5B21CDA916876307B3C1AEBF0D0A20A9F4109C289578B96E6283AB13E4741FB489FC147FB1A5F446A314BA73C052131EFB04B83247A0BCEDF5205202AD64188B24B0BC5B51A17AEB218BD98DBE000C843B9",
            "error": {
                "type": "RecoveryDataError",
                "message": "Invalid certificate in recovery data"
            },
            "comment": "last signature in the certificate is invalid"
        },
        {
            "hostseckey": "631C047D50A67E45E27ED1FF25FCE179",
            "recovery_data": "0000000203B74C6FD38288DDF94300E887B12DD40F655791144A07C32487FBD81CC228C07903B9C3F15E5C0E086EDE931D69BABD36167BE6CCA8705378F8849A4F00EDA2941303AED316469060698D774150EFD7F8F406A2BAB516DD7D22CB258323C59C6417F303AEB5AE20783D4858F6767747963F144C7DB8ABA328625CC8A87F7676D8CDEEE7021A48BBCCAC751AE9EC1EA7A7F8D421D5FD60AAB44E6D2F37B31873098A77B7A30260537C74BC2B79676CDE217FFA7D48236D4A309954153DEB39A31AADF6B369CC022E7B7DD7A0B4A72097703E60648B615A4DDDF2D715A5E0992379537A44C13AD103D1FD5A186167E5DE84B11C0F56E1FC6808D2DB35E6E3587243CF59DE605CB806E242A37A2E03838EDCB4B064425FBA5F5F8331EDDF79B46AACC70EEB714995A27B5A879577BDAF956EC9F1C234BD3942E2B2F0E372902637993C54815B69F7EAFF288C16C20D3F8D26B64E23599E6996A833E286FEAD5A7490151202E859E484359973EEDDB358A5DF67A8F51EE4B4849877711B2F03A8B911E5365A5F580E6740F0CB72B94409488A4918624C3501EBEA14A65777BF59E390E0F2973A39D87F6EED8B1E9FF0C540CA119BCBBCC3E67D45A5F3BA3CAB251EC9C00B65E58C3C9AAD0DC5DFD9D9FB4624BA1313598AD5B21CDA916876307B3C1AEBF0D0A20A9F419E759E4AC146A6564712B6A0177F9DC7F03F56B7DEF40E7E0925EE99965568FF66F8D06CF0276DDAE74125FC34020DC6EA57C108562FB4908DA67E307BD74514",
            "error": {
                "type": "HostSeckeyError"
            },
            "comment": "invalid hostseckey"
        },
        {
            "hostseckey": "759DE9306FB02B3D84C455112BF1F3360401DC383ECD1FCEDE59EC809D6F9FE7",
            "recovery_data": "0000000203B74C6FD38288DDF94300E887B12DD40F655791144A07C32487FBD81CC228C07903B9C3F15E5C0E086EDE931D69BABD36167BE6CCA8705378F8849A4F00EDA2941303AED316469060698D774150EFD7F8F406A2BAB516DD7D22CB258323C59C6417F303AEB5AE20783D4858F6767747963F144C7DB8ABA328625CC8A87F7676D8CDEEE7021A48BBCCAC751AE9EC1EA7A7F8D421D5FD60AAB44E6D2F37B31873098A77B7A30260537C74BC2B79676CDE217FFA7D48236D4A309954153DEB39A31AADF6B369CC022E7B7DD7A0B4A72097703E60648B615A4DDDF2D715A5E0992379537A44C13AD103D1FD5A186167E5DE84B11C0F56E1FC6808D2DB35E6E3587243CF59DE605CB806E242A37A2E03838EDCB4B064425FBA5F5F8331EDDF79B46AACC70EEB714995A27B5A879577BDAF956EC9F1C234BD3942E2B2F0E372902637993C54815B69F7EAFF288C16C20D3F8D26B64E23599E6996A833E286FEAD5A7490151202E859E484359973EEDDB358A5DF67A8F51EE4B4849877711B2F03A8B911E5365A5F580E6740F0CB72B94409488A4918624C3501EBEA14A65777BF59E390E0F2973A39D87F6EED8B1E9FF0C540CA119BCBBCC3E67D45A5F3BA3CAB251EC9C00B65E58C3C9AAD0DC5DFD9D9FB4624BA1313598AD5B21CDA916876307B3C1AEBF0D0A20A9F419E759E4AC146A6564712B6A0177F9DC7F03F56B7DEF40E7E0925EE99965568FF66F8D06CF0276DDAE74125FC34020DC6EA57C108562FB4908DA67E307BD74514",
            "error": {
                "type": "HostSeckeyError",
                "message": "Host secret key does not match any host public key in the recovery data"
            },
            "comment": "host secret key doesn't match any hostpubkey"
        }
    ]
}